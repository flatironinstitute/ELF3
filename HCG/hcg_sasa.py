import numpy as np
import mdtraj as md
import matplotlib.pyplot as plt

q0=np.loadtxt('sasa_0q_290K.dat')
q7=np.loadtxt('sasa_7q_290K.dat')
q13=np.loadtxt('sasa_13q_290K.dat')
q19=np.loadtxt('sasa_19q_290K.dat')
dticks1=range(432,598)
dticks2=range(432,605)
dticks3=range(432,611)
dticks4=range(432,617)
fig, axs = plt.subplots(4,figsize=(9,6.5), dpi=300)
axs[0].plot(dticks1,q0,color='limegreen')
axs[1].plot(dticks2,q7,color='limegreen')
axs[2].plot(dticks3,q13,color='limegreen')
axs[3].plot(dticks4,q19,color='limegreen')
axs[0].set_xlim([432,616])
axs[0].set_ylim([0.3,2.5])
axs[1].set_xlim([432,616])
axs[1].set_ylim([0.3,2.5])
axs[2].set_xlim([432,616])
axs[2].set_ylim([0.3,2.5])
axs[3].set_xlim([432,616])
axs[3].set_ylim([0.3,2.5])

axs[0].text(s='0Q',x=444,y=2,fontsize=20)
axs[1].text(s='7Q',x=444,y=2,fontsize=20)
axs[2].text(s='13Q',x=444,y=2,fontsize=20)
axs[3].text(s='19Q',x=444,y=2,fontsize=20)


x=range(186)
axs[0].tick_params(axis='x',labelsize=0)
axs[0].tick_params(axis='y',labelsize=18)
axs[1].tick_params(axis='x',labelsize=0)
axs[1].tick_params(axis='y',labelsize=18)
axs[2].tick_params(axis='x',labelsize=0)
axs[2].tick_params(axis='y',labelsize=18)
axs[3].tick_params(axis='x',labelsize=18)
axs[3].tick_params(axis='y',labelsize=18)
plt.xlim([432,616])

axs[0].set_xticks(dticks4[::20])
axs[1].set_xticks(dticks4[::20])
axs[2].set_xticks(dticks4[::20])
axs[3].set_xticks(dticks4[::20])
axs[3].set_xticklabels(dticks4[::20])

plt.xlabel('Residue Index',fontsize=24)
plt.ylabel('Surface Area (nm$^2$)',fontsize=24,loc='top')
axs[3].yaxis.set_label_coords(-.05,3.5)
plt.subplots_adjust(hspace=0)

axs[1].axvspan(544,550,color='deepskyblue',alpha=0.5, lw=0)
axs[2].axvspan(544,556,color='deepskyblue',alpha=0.5, lw=0)
axs[3].axvspan(544,563,color='deepskyblue',alpha=0.5, lw=0)

axs[0].axvspan(561,565,color='blue',alpha=0.3, lw=0)
axs[1].axvspan(568,572,color='blue',alpha=0.3, lw=0)
axs[2].axvspan(574,578,color='blue',alpha=0.3, lw=0)
axs[3].axvspan(580,584,color='blue',alpha=0.3, lw=0)

axs[0].axvspan(574,578,color='blue',alpha=0.3, lw=0)
axs[1].axvspan(581,585,color='blue',alpha=0.3, lw=0)
axs[2].axvspan(587,591,color='blue',alpha=0.3, lw=0)
axs[3].axvspan(593,599,color='blue',alpha=0.3, lw=0)
axs[0].axhline(y=1.32, color='gray',linestyle='--')
axs[1].axhline(y=1.32, color='gray',linestyle='--')
axs[2].axhline(y=1.32, color='gray',linestyle='--')
axs[3].axhline(y=1.32, color='gray',linestyle='--')
plt.savefig('sasa_hcg_temp.png')
